#!/usr/bin/env node
import { resolveConfig } from 'vite';
import { b as buildPluginName } from './shared/vite-plugin-linter.6c199188.mjs';
import './lintWorkerThread.mjs';
import 'url';
import 'worker_threads';
import 'fs';
import 'path';

async function lint() {
  const config = await resolveConfig({}, "build");
  const plugin = config.plugins.find((p) => p.name === buildPluginName);
  if (!plugin) {
    throw new Error(`Could not find plugin ${buildPluginName}`);
  }
  const outputLines = await plugin.lintFolder(
    process.cwd()
  );
  if (outputLines.length > 0) {
    for (const output of outputLines) {
      console.warn(output);
    }
    console.error("Linting failed, see above output");
    process.exit(1);
  }
}
global.vitePluginLinter = { mode: "lintCommand" };
lint();
